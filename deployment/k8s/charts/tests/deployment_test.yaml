suite: test deployment
templates:
  - deployment.yaml
tests:
  - it: should use Chart.appVersion when image.tag is unset
    set:
      image.tag: null
    asserts:
      - matchRegex:
          path: spec.template.spec.containers[0].image
          pattern: ^ghcr\.io/sentinel-hub/titiler-openeo:[0-9]+\.[0-9]+\.[0-9]+$

  - it: should use custom tag when image.tag is set
    set:
      image.tag: "1.2.3"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].image
          value: ghcr.io/sentinel-hub/titiler-openeo:1.2.3
